name: 'Prepare Rust'
description: 'Sets up rust'
inputs:
  system_packages:
    description: 'System packages to install'
    required: false
    default: 'libdbus-1-dev libssl-dev pkg-config gcc curl'
  rust_components:
    description: 'Rust components to install'
    required: false
    default: 'rustfmt, clippy'
runs:
  using: "composite"
  steps:
      - name: Install required packages
        run: |
          set -e
          SUDO=`which sudo 2>/dev/null` || true
          $SUDO apt-get update
          $SUDO apt-get install -y ${{ inputs.system_packages }}
        shell: bash
      - name: Install stable toolchain
        uses: actions-rs/toolchain@9e120dd99b0fbad1c065f686657e914e76bd7b72
        with:
          profile: minimal
          toolchain: stable
          override: true
          components: ${{ inputs.rust_components }}
